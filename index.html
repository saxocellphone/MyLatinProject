<!DOCTYPE html>
<html>
	<head>
		<title>A solids of revolution graphing calculator</title>
		<link rel="shortcut icon" href="https://lh6.googleusercontent.com/-eJP7CsCRims/AAAAAAAAAAI/AAAAAAAAAOE/9fdQHCWUWQs/s32-c-k-no/photo.jpg"/>
		<meta charset="UTF-8">
	</head>

	<body>

		<script src="js/three.min.js"></script>
		<script src="js/CanvasInput.js"></script>
		<script src="js/ThreeCSG.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/ColladaLoader.js"></script>
		<script>
			"use strict";
			var camera, scene, renderer, loader, clock, roman, dae;
			clock = new THREE.Clock();
			loader = new THREE.ColladaLoader();
			loader.options.convertUpAxis = true;

			loader.load('HAHA.dae', function(collada){
				dae = collada.scene;
				init();
				dae.traverse(function(child){
					if(child instanceof THREE.SkinnedMesh){
						var animation = new THREE.Animation( child, child.geometry.animation );
						animation.play();
					}
				});

				scene.add(dae);
				console.log(scene.children);
			});
			// var loader = new THREE.JSONLoader();
			// var mesh;
			// loader.load( 'test.js', function ( geometry, materials ) {
			// 	mesh = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial());
			// 	mesh.scale.set( 2, 2, 2 );
        	// 	mesh.position.y = 150;
        	// 	mesh.position.x = 0;
			// 	init();
			// });
			function init(){
				if(!Detector.webgl){  //No WebGL D:
					Detector.addGetWebGLMessage();
					return;
				}
				scene=new THREE.Scene();

				camera=new THREE.PerspectiveCamera(40, window.innerWidth/window.innerHeight, 1, 1000);
				camera.position.set(0,1,5);


				loader = new THREE.JSONLoader();
				// loader.load('un.json', function(geometry, materials){
				// 	materials.forEach(function(mat){
				// 		mat.skinning = true;
				// 	});
				// 	var skinMesh = new THREE.SkinnedMesh(geometry, new THREE.MeshFaceMaterial(materials));
				// 	var idle = new THREE.Animation(skinMesh, geometry.animations[0], THREE.AnimationHandler.CATMULLROM);
				// 	var rest = new THREE.Animation(skinMesh, geometry.animations[1], THREE.AnimationHandler.CATMULLROM);
				// 	var run = new THREE.Animation(skinMesh, geometry.animations[2], THREE.AnimationHandler.CATMULLROM);
				//
				// 	scene.add(skinMesh);
				// 	idle.play();
				// });
				roman = new THREE.Object3D();
				loader.load('cube.json', function(geometry, materials){

					mesh = new THREE.Mesh(geometry, new THREE.MeshFaceMaterial(materials));
					mesh.position.x = 400;
					mesh.scale.x = mesh.scale.y = mesh.scale.z = 250;
					scene.add(mesh);
				});
				scene.add(roman);
				renderer=new THREE.WebGLRenderer({antialias: true, alpha: true });
				renderer.setSize(window.innerWidth, window.innerHeight);
				document.body.appendChild(renderer.domElement);

				addLights();
				animate();

			}
			function animate(){
				setTimeout(function(){
					requestAnimationFrame(animate);
				}, 100)


				THREE.AnimationHandler.update( clock.getDelta() );
				render();
			}

			function render(){
				renderer.render(scene, camera);
			}

			function addLights(){
				var ambientLight=new THREE.HemisphereLight(0x7ec0ee, 0.01);
				//scene.add(ambientLight);
				var directionalLight = new THREE.DirectionalLight(0xffffff);
				directionalLight.position.set(0,1,0);
				//scene.add(directionalLight);
			}

		</script>
	</body>
</html>
